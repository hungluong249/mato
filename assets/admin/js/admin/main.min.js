$("#ok").css("display","none");$("#edit").click(function(){$("#ok").css("display","block");$(".go_back").css("display","none");$(this).css("display","none");$("input").removeAttr("disabled");$("select").removeAttr("disabled");$(".mce-toolbar").show();tinymce.activeEditor.getBody().setAttribute("contenteditable",true);return false});$(window).on("load",function(){if($("textarea").hasClass("txt_hide")){$(".mce-toolbar").hide();tinymce.activeEditor.getBody().setAttribute("contenteditable",false)}});$(document).ready(function(){var a=window.location.pathname;$("#check-all").change(function(){var b=$(this).closest("form").find(":checkbox");if($(this).is(":checked")){b.prop("checked",true)}else{b.prop("checked",false)}});$(".checkbox").change(function(){if($(".checkbox:checked").length==$(".checkbox").length){$("#check-all").prop("checked",true)}else{$("#check-all").prop("checked",false)}});if($("#select_main").length==1&&$("#select_category").length==1&&$("#url").length==1){$("#menu-form").validate({rules:{title:{required:true},select_main:{required:true},select_category:{required:true},url:{required:true}},messages:{title:{required:"Cần nhập tên menu"},select_main:{required:"Cần chọn menu chính"},select_category:{required:"Cần chọn danh mục hoặc bài viết"},url:{required:"Đường dẫn không được trống"}}})}else{$("#menu-form").validate({rules:{title:{required:true}},messages:{title:{required:"Cần nhập tên menu"}}})}});$(".cat").change(function(){var a=$(this).val();if(a==1){$(".sub-cat").slideDown()}else{$(".sub-cat").slideUp()}return false});$(".btn-remove").click(function(c){c.preventDefault();var b=$(this).data("image");var d=$(this).data("id");var a=$(this).attr("href");if(confirm("Chắc chắn xóa?")){$(this).parents("tr").fadeOut();$.ajax({url:a,type:"GET",data:{id:d,image_id:b}})}return false});$(".btn-remove-category").click(function(c){c.preventDefault();var d=$(this).attr("data-id");var a=$(this);var b=$(this).attr("href");if(confirm("Chắc chắn xóa?")){jQuery.ajax({method:"get",url:b,data:{id:d},success:function(e){if(JSON.parse(e).isExists==false){alert("Vui lòng xóa bài viết trong danh mục này trước")}else{$(a).parents("tr").fadeOut()}}})}return false});$("#select_main").change(function(){if($("#select_main").val()=="article"){$("#select_article").prop("disabled",true)}else{$("#select_article").prop("disabled",false)}$("#select_category").html("");$("#select_article").html("");$.ajax({method:"GET",url:location.protocol+"//"+location.host+(location.port?":"+location.port:"")+"/tuoithantien/admin/menu/fetch_category",data:{main_category:$("#select_main").val()},success:function(b){var a=JSON.parse(b).data;if($("#select_main").val()=="article"){$("#select_article").prop("disabled",true);$("#select_category").append($("<option>",{value:"",text:"Chọn bài viết"}))}else{$("#select_article").prop("disabled",false);$("#select_category").append($("<option>",{value:"",text:"Chọn danh mục"}))}$.each(a,function(c,d){$("#select_category").append($("<option>",{value:d.slug,text:d.title}))})},error:function(){}})});$("#select_category").change(function(){var a=build_main_string();$("#url").val(location.protocol+"//"+location.host+(location.port?":"+location.port:"")+"/tuoithantien/"+a+"/"+$("#select_category").val());if($("#select_main").val()!="article"){$("#select_article").html("");$.ajax({method:"GET",url:location.protocol+"//"+location.host+(location.port?":"+location.port:"")+"/tuoithantien/admin/menu/fetch_article",data:{main_category:$("#select_main").val(),sub_category:$("#select_category").val()},success:function(b){var c=JSON.parse(b).data;$("#select_article").append($("<option>",{value:"",text:"Chọn bài viết"}));$.each(c,function(d,e){$("#select_article").append($("<option>",{value:e.slug,text:e.title}))})},error:function(){}})}});$("#select_article").change(function(){var a=build_main_string();if($("#select_article").val()===""||$("#select_article").val()===null){$("#url").val(location.protocol+"//"+location.host+(location.port?":"+location.port:"")+"/tuoithantien/"+a+"/"+$("#select_category").val())}else{$("#url").val(location.protocol+"//"+location.host+(location.port?":"+location.port:"")+"/tuoithantien/"+a+"/"+$("#select_category").val()+"/"+$("#select_article").val())}});function build_main_string(){var a="";switch($("#select_main").val()){case"introduce_category":a="gioi-thieu";break;case"admission_category":a="thong-tin-nhap-hoc";break;case"parental_category":a="phoi-hop-cung-phu-huynh";break;case"activity_category":a="hoat-dong";break;default:a="bai-viet";break}return a}$(".show_comment").click(function(){var b=$(this).data("category");var a=$(this).data("slug");$.ajax({url:"http://localhost/tuoithantien/admin/comment/check_status",type:"GET",data:{category:b,slug:a}})});