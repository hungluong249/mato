/*!
xCharts v0.3.0 Copyright (c) 2012, tenXer, Inc. All Rights Reserved.
@license MIT license. http://github.com/tenXer/xcharts for details
*/
(function(){var b,d={},a={},n={};(function(){var ak=this,ae=ak._,ag={},au=Array.prototype,ad=Object.prototype,ap=Function.prototype,ay=au.push,aj=au.slice,aw=au.concat,am=ad.toString,at=ad.hasOwnProperty,af=au.forEach,ai=au.map,ac=au.reduce,aq=au.reduceRight,ar=au.filter,av=au.every,al=au.some,Z=au.indexOf,ax=au.lastIndexOf,aa=Array.isArray,az=Object.keys,ao=ap.bind,ab=function(o){return o instanceof ab?o:this instanceof ab?(this._wrapped=o,void 0):new ab(o)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=ab),exports._=ab):ak._=ab,ab.VERSION="1.4.3";var X=ab.each=ab.forEach=function(v,r,s){if(null!=v){if(af&&v.forEach===af){v.forEach(r,s)}else{if(v.length===+v.length){for(var p=0,q=v.length;q>p;p++){if(r.call(s,v[p],p,v)===ag){return}}}else{for(var o in v){if(ab.has(v,o)&&r.call(s,v[o],o,v)===ag){return}}}}}};ab.map=ab.collect=function(s,o,p){var q=[];return null==s?q:ai&&s.map===ai?s.map(o,p):(X(s,function(v,r,t){q[q.length]=o.call(p,v,r,t)}),q)};var J="Reduce of empty array with no initial value";ab.reduce=ab.foldl=ab.inject=function(v,p,q,s){var o=arguments.length>2;if(null==v&&(v=[]),ac&&v.reduce===ac){return s&&(p=ab.bind(p,s)),o?v.reduce(p,q):v.reduce(p)}if(X(v,function(u,t,r){o?q=p.call(s,q,u,t,r):(q=u,o=!0)}),!o){throw new TypeError(J)}return q},ab.reduceRight=ab.foldr=function(x,s,v,w){var p=arguments.length>2;if(null==x&&(x=[]),aq&&x.reduceRight===aq){return w&&(s=ab.bind(s,w)),p?x.reduceRight(s,v):x.reduceRight(s)}var q=x.length;if(q!==+q){var o=ab.keys(x);q=o.length}if(X(x,function(t,u,r){u=o?o[--q]:--q,p?v=s.call(w,v,x[u],u,r):(v=x[u],p=!0)}),!p){throw new TypeError(J)}return v},ab.find=ab.detect=function(s,o,p){var q;return U(s,function(v,r,t){return o.call(p,v,r,t)?(q=v,!0):void 0}),q},ab.filter=ab.select=function(s,o,p){var q=[];return null==s?q:ar&&s.filter===ar?s.filter(o,p):(X(s,function(v,r,t){o.call(p,v,r,t)&&(q[q.length]=v)}),q)},ab.reject=function(q,o,p){return ab.filter(q,function(t,s,r){return !o.call(p,t,s,r)},p)},ab.every=ab.all=function(r,p,q){p||(p=ab.identity);var o=!0;return null==r?o:av&&r.every===av?r.every(p,q):(X(r,function(u,t,s){return(o=o&&p.call(q,u,t,s))?void 0:ag}),!!o)};var U=ab.some=ab.any=function(r,p,q){p||(p=ab.identity);var o=!1;return null==r?o:al&&r.some===al?r.some(p,q):(X(r,function(u,t,s){return o||(o=p.call(q,u,t,s))?ag:void 0}),!!o)};ab.contains=ab.include=function(p,o){return null==p?!1:Z&&p.indexOf===Z?-1!=p.indexOf(o):U(p,function(q){return q===o})},ab.invoke=function(q,o){var p=aj.call(arguments,2);return ab.map(q,function(r){return(ab.isFunction(o)?o:r[o]).apply(r,p)})},ab.pluck=function(p,o){return ab.map(p,function(q){return q[o]})},ab.where=function(p,o){return ab.isEmpty(o)?[]:ab.filter(p,function(s){for(var q in o){if(o[q]!==s[q]){return !1}}return !0})},ab.max=function(s,o,p){if(!o&&ab.isArray(s)&&s[0]===+s[0]&&65535>s.length){return Math.max.apply(Math,s)}if(!o&&ab.isEmpty(s)){return -1/0}var q={computed:-1/0,value:-1/0};return X(s,function(w,t,v){var r=o?o.call(p,w,t,v):w;r>=q.computed&&(q={value:w,computed:r})}),q.value},ab.min=function(s,o,p){if(!o&&ab.isArray(s)&&s[0]===+s[0]&&65535>s.length){return Math.min.apply(Math,s)}if(!o&&ab.isEmpty(s)){return 1/0}var q={computed:1/0,value:1/0};return X(s,function(w,t,v){var r=o?o.call(p,w,t,v):w;q.computed>r&&(q={value:w,computed:r})}),q.value},ab.shuffle=function(s){var o,p=0,q=[];return X(s,function(r){o=ab.random(p++),q[p-1]=q[o],q[o]=r}),q};var Q=function(o){return ab.isFunction(o)?o:function(p){return p[o]}};ab.sortBy=function(s,o,p){var q=Q(o);return ab.pluck(ab.map(s,function(w,v,r){return{value:w,index:v,criteria:q.call(p,w,v,r)}}).sort(function(x,u){var v=x.criteria,w=u.criteria;if(v!==w){if(v>w||void 0===v){return 1}if(w>v||void 0===w){return -1}}return x.index<u.index?-1:1}),"value")};var an=function(w,q,s,v){var o={},p=Q(q||ab.identity);return X(w,function(u,r){var x=p.call(s,u,r,w);v(o,x,u)}),o};ab.groupBy=function(q,o,p){return an(q,o,p,function(v,s,u){(ab.has(v,s)?v[s]:v[s]=[]).push(u)})},ab.countBy=function(q,o,p){return an(q,o,p,function(s,r){ab.has(s,r)||(s[r]=0),s[r]++})},ab.sortedIndex=function(z,v,w,x){w=null==w?ab.identity:Q(w);for(var q=w.call(x,v),s=0,p=z.length;p>s;){var y=s+p>>>1;q>w.call(x,z[y])?s=y+1:p=y}return s},ab.toArray=function(o){return o?ab.isArray(o)?aj.call(o):o.length===+o.length?ab.map(o,ab.identity):ab.values(o):[]},ab.size=function(o){return null==o?0:o.length===+o.length?o.length:ab.keys(o).length},ab.first=ab.head=ab.take=function(q,o,p){return null==q?void 0:null==o||p?q[0]:aj.call(q,0,o)},ab.initial=function(q,o,p){return aj.call(q,0,q.length-(null==o||p?1:o))},ab.last=function(q,o,p){return null==q?void 0:null==o||p?q[q.length-1]:aj.call(q,Math.max(q.length-o,0))},ab.rest=ab.tail=ab.drop=function(q,o,p){return aj.call(q,null==o||p?1:o)},ab.compact=function(o){return ab.filter(o,ab.identity)};var H=function(q,o,p){return X(q,function(r){ab.isArray(r)?o?ay.apply(p,r):H(r,o,p):p.push(r)}),p};ab.flatten=function(p,o){return H(p,o,[])},ab.without=function(o){return ab.difference(o,aj.call(arguments,1))},ab.uniq=ab.unique=function(x,s,v,w){ab.isFunction(s)&&(w=v,v=s,s=!1);var p=v?ab.map(x,v,w):x,q=[],o=[];return X(p,function(t,u){(s?u&&o[o.length-1]===t:ab.contains(o,t))||(o.push(t),q.push(x[u]))}),q},ab.union=function(){return ab.uniq(aw.apply(au,arguments))},ab.intersection=function(p){var o=aj.call(arguments,1);return ab.filter(ab.uniq(p),function(q){return ab.every(o,function(r){return ab.indexOf(r,q)>=0})})},ab.difference=function(p){var o=aw.apply(au,aj.call(arguments,1));return ab.filter(p,function(q){return !ab.contains(o,q)})},ab.zip=function(){for(var s=aj.call(arguments),o=ab.max(ab.pluck(s,"length")),p=Array(o),q=0;o>q;q++){p[q]=ab.pluck(s,""+q)}return p},ab.object=function(v,p){if(null==v){return{}}for(var q={},s=0,o=v.length;o>s;s++){p?q[v[s]]=p[s]:q[v[s][0]]=v[s][1]}return q},ab.indexOf=function(v,p,q){if(null==v){return -1}var s=0,o=v.length;if(q){if("number"!=typeof q){return s=ab.sortedIndex(v,p),v[s]===p?s:-1}s=0>q?Math.max(0,o+q):q}if(Z&&v.indexOf===Z){return v.indexOf(p,q)}for(;o>s;s++){if(v[s]===p){return s}}return -1},ab.lastIndexOf=function(v,p,q){if(null==v){return -1}var s=null!=q;if(ax&&v.lastIndexOf===ax){return s?v.lastIndexOf(p,q):v.lastIndexOf(p)}for(var o=s?q:v.length;o--;){if(v[o]===p){return o}}return -1},ab.range=function(w,q,s){1>=arguments.length&&(q=w||0,w=0),s=arguments[2]||1;for(var v=Math.max(Math.ceil((q-w)/s),0),o=0,p=Array(v);v>o;){p[o++]=w,w+=s}return p};var P=function(){};ab.bind=function(s,o){var p,q;if(s.bind===ao&&ao){return ao.apply(s,aj.call(arguments,1))}if(!ab.isFunction(s)){throw new TypeError}return p=aj.call(arguments,2),q=function(){if(!(this instanceof q)){return s.apply(o,p.concat(aj.call(arguments)))}P.prototype=s.prototype;var r=new P;P.prototype=null;var t=s.apply(r,p.concat(aj.call(arguments)));return Object(t)===t?t:r}},ab.bindAll=function(p){var o=aj.call(arguments,1);return 0==o.length&&(o=ab.functions(p)),X(o,function(q){p[q]=ab.bind(p[q],p)}),p},ab.memoize=function(q,o){var p={};return o||(o=ab.identity),function(){var r=o.apply(this,arguments);return ab.has(p,r)?p[r]:p[r]=q.apply(this,arguments)}},ab.delay=function(q,o){var p=aj.call(arguments,2);return setTimeout(function(){return q.apply(null,p)},o)},ab.defer=function(o){return ab.delay.apply(ab,[o,1].concat(aj.call(arguments,1)))},ab.throttle=function(z,v){var w,x,q,s,p=0,y=function(){p=new Date,q=null,s=z.apply(w,x)};return function(){var r=new Date,o=v-(r-p);return w=this,x=arguments,0>=o?(clearTimeout(q),q=null,p=r,s=z.apply(w,x)):q||(q=setTimeout(y,o)),s}},ab.debounce=function(v,p,q){var s,o;return function(){var t=this,r=arguments,u=function(){s=null,q||(o=v.apply(t,r))},w=q&&!s;return clearTimeout(s),s=setTimeout(u,p),w&&(o=v.apply(t,r)),o}},ab.once=function(q){var o,p=!1;return function(){return p?o:(p=!0,o=q.apply(this,arguments),q=null,o)}},ab.wrap=function(p,o){return function(){var q=[p];return ay.apply(q,arguments),o.apply(this,q)}},ab.compose=function(){var o=arguments;return function(){for(var p=arguments,q=o.length-1;q>=0;q--){p=[o[q].apply(this,p)]}return p[0]}},ab.after=function(p,o){return 0>=p?o():function(){return 1>--p?o.apply(this,arguments):void 0}},ab.keys=az||function(q){if(q!==Object(q)){throw new TypeError("Invalid object")}var o=[];for(var p in q){ab.has(q,p)&&(o[o.length]=p)}return o},ab.values=function(q){var o=[];for(var p in q){ab.has(q,p)&&o.push(q[p])}return o},ab.pairs=function(q){var o=[];for(var p in q){ab.has(q,p)&&o.push([p,q[p]])}return o},ab.invert=function(q){var o={};for(var p in q){ab.has(q,p)&&(o[q[p]]=p)}return o},ab.functions=ab.methods=function(q){var o=[];for(var p in q){ab.isFunction(q[p])&&o.push(p)}return o.sort()},ab.extend=function(o){return X(aj.call(arguments,1),function(p){if(p){for(var q in p){o[q]=p[q]}}}),o},ab.pick=function(q){var o={},p=aw.apply(au,aj.call(arguments,1));return X(p,function(s){s in q&&(o[s]=q[s])}),o},ab.omit=function(s){var p={},q=aw.apply(au,aj.call(arguments,1));for(var o in s){ab.contains(q,o)||(p[o]=s[o])}return p},ab.defaults=function(o){return X(aj.call(arguments,1),function(p){if(p){for(var q in p){null==o[q]&&(o[q]=p[q])}}}),o},ab.clone=function(o){return ab.isObject(o)?ab.isArray(o)?o.slice():ab.extend({},o):o},ab.tap=function(p,o){return o(p),p};var G=function(v,D,p,y){if(v===D){return 0!==v||1/v==1/D}if(null==v||null==D){return v===D}v instanceof ab&&(v=v._wrapped),D instanceof ab&&(D=D._wrapped);var B=am.call(v);if(B!=am.call(D)){return !1}switch(B){case"[object String]":return v==D+"";case"[object Number]":return v!=+v?D!=+D:0==v?1/v==1/D:v==+D;case"[object Date]":case"[object Boolean]":return +v==+D;case"[object RegExp]":return v.source==D.source&&v.global==D.global&&v.multiline==D.multiline&&v.ignoreCase==D.ignoreCase}if("object"!=typeof v||"object"!=typeof D){return !1}for(var w=p.length;w--;){if(p[w]==v){return y[w]==D}}p.push(v),y.push(D);var A=0,q=!0;if("[object Array]"==B){if(A=v.length,q=A==D.length){for(;A--&&(q=G(v[A],D[A],p,y));){}}}else{var z=v.constructor,x=D.constructor;if(z!==x&&!(ab.isFunction(z)&&z instanceof z&&ab.isFunction(x)&&x instanceof x)){return !1}for(var E in v){if(ab.has(v,E)&&(A++,!(q=ab.has(D,E)&&G(v[E],D[E],p,y)))){break}}if(q){for(E in D){if(ab.has(D,E)&&!A--){break}}q=!A}}return p.pop(),y.pop(),q};ab.isEqual=function(p,o){return G(p,o,[],[])},ab.isEmpty=function(p){if(null==p){return !0}if(ab.isArray(p)||ab.isString(p)){return 0===p.length}for(var o in p){if(ab.has(p,o)){return !1}}return !0},ab.isElement=function(o){return !(!o||1!==o.nodeType)},ab.isArray=aa||function(o){return"[object Array]"==am.call(o)},ab.isObject=function(o){return o===Object(o)},X(["Arguments","Function","String","Number","Date","RegExp"],function(o){ab["is"+o]=function(p){return am.call(p)=="[object "+o+"]"}}),ab.isArguments(arguments)||(ab.isArguments=function(o){return !(!o||!ab.has(o,"callee"))}),ab.isFunction=function(o){return"function"==typeof o},ab.isFinite=function(o){return isFinite(o)&&!isNaN(parseFloat(o))},ab.isNaN=function(o){return ab.isNumber(o)&&o!=+o},ab.isBoolean=function(o){return o===!0||o===!1||"[object Boolean]"==am.call(o)},ab.isNull=function(o){return null===o},ab.isUndefined=function(o){return void 0===o},ab.has=function(p,o){return at.call(p,o)},ab.noConflict=function(){return ak._=ae,this},ab.identity=function(o){return o},ab.times=function(v,p,q){for(var s=Array(v),o=0;v>o;o++){s[o]=p.call(q,o)}return s},ab.random=function(p,o){return null==o&&(o=p,p=0),p+(0|Math.random()*(o-p+1))};var C={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};C.unescape=ab.invert(C.escape);var L={escape:RegExp("["+ab.keys(C.escape).join("")+"]","g"),unescape:RegExp("("+ab.keys(C.unescape).join("|")+")","g")};ab.each(["escape","unescape"],function(o){ab[o]=function(p){return null==p?"":(""+p).replace(L[o],function(q){return C[o][q]})}}),ab.result=function(q,o){if(null==q){return null}var p=q[o];return ab.isFunction(p)?p.call(q):p},ab.mixin=function(o){X(ab.functions(o),function(p){var q=ab[p]=o[p];ab.prototype[p]=function(){var r=[this._wrapped];return ay.apply(r,arguments),Y.call(this,q.apply(ab,r))}})};var K=0;ab.uniqueId=function(p){var o=""+ ++K;return p?p+o:o},ab.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ah=/(.)^/,W={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\t|\u2028|\u2029/g;ab.template=function(s,A,p){p=ab.defaults({},p,ab.templateSettings);var w=RegExp([(p.escape||ah).source,(p.interpolate||ah).source,(p.evaluate||ah).source].join("|")+"|$","g"),z=0,v="__p+='";s.replace(w,function(B,D,E,u,F){return v+=s.slice(z,F).replace(V,function(o){return"\\"+W[o]}),D&&(v+="'+\n((__t=("+D+"))==null?'':_.escape(__t))+\n'"),E&&(v+="'+\n((__t=("+E+"))==null?'':__t)+\n'"),u&&(v+="';\n"+u+"\n__p+='"),z=F+B.length,B}),v+="';\n",p.variable||(v="with(obj||{}){\n"+v+"}\n"),v="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+v+"return __p;\n";try{var y=Function(p.variable||"obj","_",v)}catch(q){throw q.source=v,q}if(A){return y(A,ab)}var x=function(o){return y.call(this,o,ab)};return x.source="function("+(p.variable||"obj")+"){\n"+v+"}",x},ab.chain=function(o){return ab(o).chain()};var Y=function(o){return this._chain?ab(o).chain():o};ab.mixin(ab),X(["pop","push","reverse","shift","sort","splice","unshift"],function(p){var o=au[p];ab.prototype[p]=function(){var q=this._wrapped;return o.apply(q,arguments),"shift"!=p&&"splice"!=p||0!==q.length||delete q[0],Y.call(this,q)}}),X(["concat","join","slice"],function(p){var o=au[p];ab.prototype[p]=function(){return Y.call(this,o.apply(this._wrapped,arguments))}}),ab.extend(ab.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);function e(o){return _.chain(_.range(o,10)).reverse().map(function(p){return'g[data-index="'+p+'"]'}).value().join(", ")}function g(p,o){var q=p.getAttribute("class");return(q!==null?q.replace(/color\d+/g,""):"")+" color"+o}n={getInsertionPoint:e,colorClass:g};var i=this,k=0.25;function m(p,o){return _.chain(p).pluck("data").flatten().pluck(o).uniq().filter(function(q){return q!==undefined&&q!==null}).value().sort(d3.ascending)}a.ordinal=function(s,o,q,p){var r=m(s,o);return d3.scale.ordinal().domain(r).rangeRoundBands(q,k)};a.linear=function(r,o,q,p){return d3.scale.linear().domain(p).nice().rangeRound(q)};a.exponential=function(r,o,q,p){return d3.scale.pow().exponent(0.65).domain(p).nice().rangeRound(q)};a.time=function(r,o,q,p){return d3.time.scale().domain(_.map(p,function(s){return new Date(s)})).range(q)};function f(r,q){var p=r[0],o=r[1],t,s;if(p===o){s=Math.max(Math.round(p/10),4);p-=s;o+=s}t=o-p;p=p?p-t/10:p;p=r[0]>0?Math.max(p,0):p;o=o?o+t/10:o;o=r[1]<0?Math.min(o,0):o;return[p,o]}function h(p,t,s,o){var r,q=_.chain(t).pluck("data").flatten().value();r={x:d3.extent(q,function(u){return u.x}),y:d3.extent(q,function(u){return u.y})};_.each([s,o],function(x,v){var w=v?"y":"x",u;r[w]=d3.extent(q,function(y){return y[w]});if(x==="ordinal"){return}_.each([w+"Min",w+"Max"],function(y,z){if(x!=="time"){u=f(r[w])}if(p.hasOwnProperty(y)&&p[y]!==null){r[w][z]=p[y]}else{if(x!=="time"){r[w][z]=u[z]}}})});return r}a.xy=function(z,r,u,t){var q=z._options,w=h(q,r,u,t),v={},y=[q.axisPaddingLeft,z._width],s=[z._height,q.axisPaddingTop],x,p;_.each([u,t],function(C,o){var B=o===0?"x":"y",D=o===0?y:s,A=b.getScale(C);v[B]=A(r,B,D,w[B])});return v};(function(){var v=2,o="g.bar",r=n.getInsertionPoint(v);function p(x,y,w,z){x.xScale2=d3.scale.ordinal().domain(d3.range(0,w.length)).rangeRoundBands([0,x.xScale.rangeBand()],0.08)}function t(x,D,z,B,A){var C,w,y=x.yZero;C=x._g.selectAll(o+z).data(B,function(E){return E.className});C.enter().insert("g",r).attr("data-index",v).style("opacity",0).attr("class",function(G,F){var E=_.uniq((z+G.className).split(".")).join(" ");return E+" bar "+n.colorClass(this,F)}).attr("transform",function(F,E){return"translate("+x.xScale2(E)+",0)"});w=C.selectAll("rect").data(function(E){return E.data},function(E){return E.x});w.enter().append("rect").attr("width",0).attr("rx",3).attr("ry",3).attr("x",function(E){return x.xScale(E.x)+x.xScale2.rangeBand()/2}).attr("height",function(E){return Math.abs(y-x.yScale(E.y))}).attr("y",function(E){return E.y<0?y:x.yScale(E.y)}).on("mouseover",A.mouseover).on("mouseout",A.mouseout).on("click",A.click);D.barGroups=C;D.bars=w}function u(w,z,y){var x=w.yZero;z.barGroups.attr("class",function(B,A){return n.colorClass(this,A)}).transition().duration(y).style("opacity",1).attr("transform",function(B,A){return"translate("+w.xScale2(A)+",0)"});z.bars.transition().duration(y).attr("width",w.xScale2.rangeBand()).attr("x",function(A){return w.xScale(A.x)}).attr("height",function(A){return Math.abs(x-w.yScale(A.y))}).attr("y",function(A){return A.y<0?x:w.yScale(A.y)})}function q(w,y,x){y.bars.exit().transition().duration(x).attr("width",0).remove();y.barGroups.exit().transition().duration(x).style("opacity",0).remove()}function s(w,z,x){var y=w.xScale2?w.xScale2.rangeBand()/2:0;delete w.xScale2;z.bars.transition().duration(x).attr("width",0).attr("x",function(A){return w.xScale(A.x)+y})}d.bar={postUpdateScale:p,enter:t,update:u,exit:q,destroy:s}})();(function(){var u=3,o="g.line",q=n.getInsertionPoint(u);function s(I,B,E,A,C){var z=I._options.interpolation,H=function(y,x){if(!I.xScale2&&!I.xScale.rangeBand){return I.xScale(y.x)}return I.xScale(y.x)+I.xScale.rangeBand()/2},F=function(x){return I.yScale(x.y)},K=d3.svg.line().x(H).interpolate(z),w=d3.svg.area().x(H).y1(I.yZero).interpolate(z),v,D,J;function G(x){return[x.data]}v=I._g.selectAll(o+E).data(A,function(x){return x.className});v.enter().insert("g",q).attr("data-index",u).attr("class",function(L,y){var x=_.uniq((E+L.className).split(".")).join(" ");return x+" line "+n.colorClass(this,y)});D=v.selectAll("path.fill").data(G);D.enter().append("path").attr("class","fill").style("opacity",0).attr("d",w.y0(F));J=v.selectAll("path.line").data(G);J.enter().append("path").attr("class","line").style("opacity",0).attr("d",K.y(F));B.lineContainers=v;B.lineFills=D;B.linePaths=J;B.lineX=H;B.lineY=F;B.lineA=w;B.line=K}function t(v,x,w){x.lineContainers.attr("class",function(z,y){return n.colorClass(this,y)});x.lineFills.transition().duration(w).style("opacity",1).attr("d",x.lineA.y0(x.lineY));x.linePaths.transition().duration(w).style("opacity",1).attr("d",x.line.y(x.lineY))}function p(v,w){w.linePaths.exit().style("opacity",0).remove();w.lineFills.exit().style("opacity",0).remove();w.lineContainers.exit().remove()}function r(v,x,w){x.linePaths.transition().duration(w).style("opacity",0);x.lineFills.transition().duration(w).style("opacity",0)}d.line={enter:s,update:t,exit:p,destroy:r}})();(function(){var o=d.line;function r(t,y,u,w,v){var x;o.enter(t,y,u,w,v);x=y.lineContainers.selectAll("circle").data(function(z){return z.data},function(z){return z.x});x.enter().append("circle").style("opacity",0).attr("cx",y.lineX).attr("cy",y.lineY).attr("r",5).on("mouseover",v.mouseover).on("mouseout",v.mouseout).on("click",v.click);y.lineCircles=x}function s(t,v,u){o.update.apply(null,_.toArray(arguments));v.lineCircles.transition().duration(u).style("opacity",1).attr("cx",v.lineX).attr("cy",v.lineY)}function p(t,u){u.lineCircles.exit().remove();o.exit.apply(null,_.toArray(arguments))}function q(t,v,u){o.destroy.apply(null,_.toArray(arguments));if(!v.lineCircles){return}v.lineCircles.transition().duration(u).style("opacity",0)}d["line-dotted"]={enter:r,update:s,exit:p,destroy:q}})();(function(){var o=d["line-dotted"];function t(u,y,v,x,w){o.enter(u,y,v,x,w)}function r(v){function w(x,y){return x+y.y}var u=_.map(v,function(z){var x=z.data.length,y=_.clone(z.data);z=_.clone(z);while(x){x-=1;y[x]=_.clone(z.data[x]);y[x].y0=z.data[x].y;y[x].y=_.reduce(_.first(z.data,x),w,z.data[x].y)}return _.extend(z,{data:y})});return u}function s(u){if(!u.hasOwnProperty("cumulativeOMainData")){return}u._mainData=u.cumulativeOMainData;delete u.cumulativeOMainData;u._compData=u.cumulativeOCompData;delete u.cumulativeOCompData}function q(u,v){s(u);u.cumulativeOMainData=u._mainData;u._mainData=r(u._mainData);u.cumulativeOCompData=u._compData;u._compData=r(u._compData)}function p(u,w,v){s(u);o.destroy.apply(null,_.toArray(arguments))}d.cumulative={preUpdateScale:q,enter:t,update:o.update,exit:o.exit,destroy:p}})();var j=[[]],c={mouseover:function(p,o){},mouseout:function(p,o){},click:function(p,o){},axisPaddingTop:0,axisPaddingRight:0,axisPaddingBottom:5,axisPaddingLeft:20,paddingTop:0,paddingRight:0,paddingBottom:20,paddingLeft:60,tickHintX:10,tickFormatX:function(o){return o},tickHintY:10,tickFormatY:function(o){return o},xMin:null,xMax:null,yMin:null,yMax:null,dataFormatX:function(o){return o},dataFormatY:function(o){return o},unsupported:function(o){d3.select(o).text("SVG is not supported on your browser")},empty:function(p,o,q){},notempty:function(p,o){},timing:750,interpolation:"monotone",sortX:function(p,o){return !p.x&&!o.x?0:p.x<o.x?-1:1}};function l(){var o=document;return !!o.createElementNS&&!!o.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}function b(s,t,o,q){var p=this,r;p._options=q=_.defaults(q||{},c);if(l()===false){return q.unsupported(o)}p._selector=o;p._container=d3.select(o);p._drawSvg();p._mainStorage={};p._compStorage={};t=_.clone(t);if(s&&!t.type){t.type=s}p.setData(t);d3.select(window).on("resize.for."+o,function(){if(r){clearTimeout(r)}r=setTimeout(function(){r=null;p._resize()},500)})}b.setVis=function(o,p){if(d.hasOwnProperty(o)){throw'Cannot override vis type "'+o+'".'}d[o]=p};b.getVis=function(o){if(!d.hasOwnProperty(o)){throw'Vis type "'+o+'" does not exist.'}return _.clone(d[o])};b.setScale=function(o,p){if(a.hasOwnProperty(o)){throw'Scale type "'+o+'" already exists.'}a[o]=p};b.getScale=function(o){if(!a.hasOwnProperty(o)){throw'Scale type "'+o+'" does not exist.'}return a[o]};b.visutils=n;_.defaults(b.prototype,{setType:function(p,q){var o=this;if(o._type&&p===o._type){return}if(!d.hasOwnProperty(p)){throw'Vis type "'+p+'" is not defined.'}if(o._type){o._destroy(o._vis,o._mainStorage)}o._type=p;o._vis=d[p];if(!q){o._draw()}},setData:function(s){var p=this,t=p._options,q=_.clone(s);if(!s.hasOwnProperty("main")){throw'No "main" key found in given chart data.'}switch(s.type){case"bar":s.xScale="ordinal";break;case undefined:s.type=p._type;break}t.xMin=isNaN(parseInt(s.xMin,10))?t.xMin:s.xMin;t.xMax=isNaN(parseInt(s.xMax,10))?t.xMax:s.xMax;t.yMin=isNaN(parseInt(s.yMin,10))?t.yMin:s.yMin;t.yMax=isNaN(parseInt(s.yMax,10))?t.yMax:s.yMax;if(p._vis){p._destroy(p._vis,p._mainStorage)}p.setType(s.type,true);function r(u){var o=_.map(_.clone(u.data),function(w){var v=_.clone(w);if(w.hasOwnProperty("x")){v.x=t.dataFormatX(w.x)}if(w.hasOwnProperty("y")){v.y=t.dataFormatY(w.y)}return v}).sort(t.sortX);return _.extend(_.clone(u),{data:o})}q.main=_.map(q.main,r);p._mainData=q.main;p._xScaleType=q.xScale;p._yScaleType=q.yScale;if(q.hasOwnProperty("comp")){q.comp=_.map(q.comp,r);p._compData=q.comp}else{p._compData=[]}p._draw()},setScale:function(q,p){var o=this;switch(q){case"x":o._xScaleType=p;break;case"y":o._yScaleType=p;break;default:throw'Cannot change scale of unknown axis "'+q+'".'}o._draw()},_drawSvg:function(){var r=this,v=r._container,s=r._options,t=parseInt(v.style("width").replace("px",""),10),o=parseInt(v.style("height").replace("px",""),10),q,u,p;q=v.selectAll("svg").data(j);q.enter().append("svg").attr("height",o).attr("width",t).attr("class","xchart");q.transition().attr("width",t).attr("height",o);u=q.selectAll("g").data(j);u.enter().append("g").attr("transform","translate("+s.paddingLeft+","+s.paddingTop+")");p=u.selectAll("g.scale").data(j);p.enter().append("g").attr("class","scale");r._svg=q;r._g=u;r._gScale=p;r._height=o-s.paddingTop-s.paddingBottom-s.axisPaddingTop-s.axisPaddingBottom;r._width=t-s.paddingLeft-s.paddingRight-s.axisPaddingLeft-s.axisPaddingRight},_resize:function(p){var o=this;o._drawSvg();o._draw()},_drawAxes:function(){if(this._noData){return}var D=this,s=D._options,C=D._gScale.transition().duration(s.timing),v=s.tickHintX,z=s.tickHintY,p=D._height+s.axisPaddingTop+s.axisPaddingBottom,y=d3.svg.line().x(function(o){return o}),A,u,r,w,q,B,x;w=d3.svg.axis().scale(D.xScale).ticks(v).tickSize(-D._height).tickFormat(s.tickFormatX).orient("bottom");r=D._gScale.selectAll("g.axisX").data(j);r.enter().append("g").attr("class","axis axisX").attr("transform","translate(0,"+p+")");r.call(w);x=D._gScale.selectAll(".axisX g")[0];if(x.length>D._width/80){x.sort(function(t,o){var E=/translate\(([^,)]+)/;t=t.getAttribute("transform").match(E);o=o.getAttribute("transform").match(E);return parseFloat(t[1],10)-parseFloat(o[1],10)});d3.selectAll(x).filter(function(t,o){return o%(Math.ceil(x.length/v)+1)}).remove()}B=d3.svg.axis().scale(D.yScale).ticks(z).tickSize(-D._width-s.axisPaddingRight-s.axisPaddingLeft).tickFormat(s.tickFormatY).orient("left");q=D._gScale.selectAll("g.axisY").data(j);q.enter().append("g").attr("class","axis axisY").attr("transform","translate(0,0)");C.selectAll("g.axisY").call(B);A=D._gScale.selectAll("g.axisZero").data([[]]);A.enter().append("g").attr("class","axisZero");u=A.selectAll("line").data([[]]);u.enter().append("line").attr("x1",0).attr("x2",D._width+s.axisPaddingLeft+s.axisPaddingRight).attr("y1",D.yZero).attr("y2",D.yZero);u.transition().duration(s.timing).attr("y1",D.yZero).attr("y2",D.yZero)},_updateScale:function(){var o=this,r=function(){return _.union(o._mainData,o._compData)},p=r(),s=o._vis,t,q;delete o.xScale;delete o.yScale;delete o.yZero;if(s.hasOwnProperty("preUpdateScale")){s.preUpdateScale(o,p,o._mainData,o._compData)}p=r();t=a.xy(o,p,o._xScaleType,o._yScaleType);o.xScale=t.x;o.yScale=t.y;q=o.yScale.domain()[0];o.yZero=q>0?o.yScale(q):o.yScale(0);if(s.hasOwnProperty("postUpdateScale")){s.postUpdateScale(o,p,o._mainData,o._compData)}},_enter:function(s,t,r,p){var o=this,q={click:o._options.click,mouseover:o._options.mouseover,mouseout:o._options.mouseout};o._checkVisMethod(s,"enter");s.enter(o,t,p,r,q)},_update:function(p,q){var o=this;o._checkVisMethod(p,"update");p.update(o,q,o._options.timing)},_exit:function(p,q){var o=this;o._checkVisMethod(p,"exit");p.exit(o,q,o._options.timing)},_destroy:function(p,r){var o=this;o._checkVisMethod(p,"destroy");try{p.destroy(o,r,o._options.timing)}catch(q){}},_draw:function(){var q=this,s=q._options,p,r;q._noData=_.flatten(_.pluck(q._mainData,"data").concat(_.pluck(q._compData,"data"))).length===0;q._updateScale();q._drawAxes();q._enter(q._vis,q._mainStorage,q._mainData,".main");q._exit(q._vis,q._mainStorage);q._update(q._vis,q._mainStorage);p=_.chain(q._compData).groupBy(function(o){return o.type});r=p.keys();_.each(q._compStorage,function(u,o){if(-1===r.indexOf(o).value()){var t=d[o];q._enter(t,u,[],".comp."+o.replace(/\W+/g,""));q._exit(t,u)}});p.each(function(u,o){var t=d[o],v;if(!q._compStorage.hasOwnProperty(o)){q._compStorage[o]={}}v=q._compStorage[o];q._enter(t,v,u,".comp."+o.replace(/\W+/g,""));q._exit(t,v);q._update(t,v)});if(q._noData){s.empty(q,q._selector,q._mainData)}else{s.notempty(q,q._selector)}},_checkVisMethod:function(p,q){var o=this;if(!p[q]){throw'Required method "'+q+'" not found on vis type "'+o._type+'".'}}});if(typeof define==="function"&&define.amd&&typeof define.amd==="object"){define(function(){return b});return}window.xChart=b})();