/*! jQuery UI - v1.11.4 - 2015-03-13
* http://jqueryui.com
* Copyright jQuery Foundation and other contributors; Licensed MIT */
(function(a){"function"==typeof define&&define.amd?define(["jquery","./core","./widget","./mouse","./draggable"],a):a(jQuery)})(function(a){return a.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var d,b=this.options,c=b.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(c)?c:function(e){return e.is(c)},this.proportions=function(){return arguments.length?(d=arguments[0],void 0):d?d:d={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(b.scope),b.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(b){a.ui.ddmanager.droppables[b]=a.ui.ddmanager.droppables[b]||[],a.ui.ddmanager.droppables[b].push(this)},_splice:function(b){for(var c=0;b.length>c;c++){b[c]===this&&b.splice(c,1)}},_destroy:function(){var b=a.ui.ddmanager.droppables[this.options.scope];this._splice(b),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(d,b){if("accept"===d){this.accept=a.isFunction(b)?b:function(e){return e.is(b)}}else{if("scope"===d){var c=a.ui.ddmanager.droppables[this.options.scope];this._splice(c),this._addToManager(b)}}this._super(d,b)},_activate:function(c){var b=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),b&&this._trigger("activate",c,this.ui(b))},_deactivate:function(c){var b=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),b&&this._trigger("deactivate",c,this.ui(b))},_over:function(c){var b=a.ui.ddmanager.current;b&&(b.currentItem||b.element)[0]!==this.element[0]&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",c,this.ui(b)))},_out:function(c){var b=a.ui.ddmanager.current;b&&(b.currentItem||b.element)[0]!==this.element[0]&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",c,this.ui(b)))},_drop:function(d,b){var c=b||a.ui.ddmanager.current,f=!1;return c&&(c.currentItem||c.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=a(this).droppable("instance");return e.options.greedy&&!e.options.disabled&&e.options.scope===c.options.scope&&e.accept.call(e.element[0],c.currentItem||c.element)&&a.ui.intersect(c,a.extend(e,{offset:e.element.offset()}),e.options.tolerance,d)?(f=!0,!1):void 0}),f?!1:this.accept.call(this.element[0],c.currentItem||c.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",d,this.ui(c)),this.element):!1):!1},ui:function(b){return{draggable:b.currentItem||b.element,helper:b.helper,position:b.position,offset:b.positionAbs}}}),a.ui.intersect=function(){function b(d,f,c){return d>=f&&f+c>d}return function(t,m,y,g){if(!m.offset){return !1}var j=(t.positionAbs||t.position.absolute).left+t.margins.left,d=(t.positionAbs||t.position.absolute).top+t.margins.top,w=j+t.helperProportions.width,k=d+t.helperProportions.height,q=m.offset.left,f=m.offset.top,v=q+m.proportions().width,x=f+m.proportions().height;switch(y){case"fit":return j>=q&&v>=w&&d>=f&&x>=k;case"intersect":return j+t.helperProportions.width/2>q&&v>w-t.helperProportions.width/2&&d+t.helperProportions.height/2>f&&x>k-t.helperProportions.height/2;case"pointer":return b(g.pageY,f,m.proportions().height)&&b(g.pageX,q,m.proportions().width);case"touch":return(d>=f&&x>=d||k>=f&&x>=k||f>d&&k>x)&&(j>=q&&v>=j||w>=q&&v>=w||q>j&&w>v);default:return !1}}}(),a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(g,c){var d,h,j=a.ui.ddmanager.droppables[g.options.scope]||[],f=c?c.type:null,b=(g.currentItem||g.element).find(":data(ui-droppable)").addBack();a:for(d=0;j.length>d;d++){if(!(j[d].options.disabled||g&&!j[d].accept.call(j[d].element[0],g.currentItem||g.element))){for(h=0;b.length>h;h++){if(b[h]===j[d].element[0]){j[d].proportions().height=0;continue a}}j[d].visible="none"!==j[d].element.css("display"),j[d].visible&&("mousedown"===f&&j[d]._activate.call(j[d],c),j[d].offset=j[d].element.offset(),j[d].proportions({width:j[d].element[0].offsetWidth,height:j[d].element[0].offsetHeight}))}}},drop:function(d,b){var c=!1;return a.each((a.ui.ddmanager.droppables[d.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(d,this,this.options.tolerance,b)&&(c=this._drop.call(this,b)||c),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,b)))}),c},dragStart:function(c,b){c.element.parentsUntil("body").bind("scroll.droppable",function(){c.options.refreshPositions||a.ui.ddmanager.prepareOffsets(c,b)})},drag:function(c,b){c.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(c,b),a.each(a.ui.ddmanager.droppables[c.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var e,g,h,f=a.ui.intersect(c,this,this.options.tolerance,b),d=!f&&this.isover?"isout":f&&!this.isover?"isover":null;d&&(this.options.greedy&&(g=this.options.scope,h=this.element.parents(":data(ui-droppable)").filter(function(){return a(this).droppable("instance").options.scope===g}),h.length&&(e=a(h[0]).droppable("instance"),e.greedyChild="isover"===d)),e&&"isover"===d&&(e.isover=!1,e.isout=!0,e._out.call(e,b)),this[d]=!0,this["isout"===d?"isover":"isout"]=!1,this["isover"===d?"_over":"_out"].call(this,b),e&&"isout"===d&&(e.isout=!1,e.isover=!0,e._over.call(e,b)))}})},dragStop:function(c,b){c.element.parentsUntil("body").unbind("scroll.droppable"),c.options.refreshPositions||a.ui.ddmanager.prepareOffsets(c,b)}},a.ui.droppable});