/*! jQuery UI - v1.11.4 - 2015-03-13
* http://jqueryui.com
* Copyright jQuery Foundation and other contributors; Licensed MIT */
(function(a){"function"==typeof define&&define.amd?define(["jquery","./core","./widget","./position","./menu"],a):a(jQuery)})(function(a){return a.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var b=this.element.uniqueId().attr("id");this.ids={element:b,button:b+"-button",menu:b+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var b=this;this.label=a("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(c){this.button.focus(),c.preventDefault()}}),this.element.hide(),this.button=a("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),a("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=a("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){b.menuItems||b._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var b=this;this.menu=a("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=a("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(d,c){d.preventDefault(),b._setSelection(),b._select(c.item.data("ui-selectmenu-item"),d)},focus:function(d,c){var e=c.item.data("ui-selectmenu-item");null!=b.focusIndex&&e.index!==b.focusIndex&&(b._trigger("focus",d,{item:e}),b.isOpen||b._select(e,d)),b.focusIndex=e.index,b.button.attr("aria-activedescendant",b.menuItems.eq(e.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return !1},this.menuInstance._isDivider=function(){return !1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var b,c=this.element.find("option");c.length&&(this._parseOptions(c),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),b=this._getSelectedItem(),this.menuInstance.focus(null,b),this._setAria(b.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(b){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",b))},_position:function(){this.menuWrap.position(a.extend({of:this.button},this.options.position))},close:function(b){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",b))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(d,b){var c=this,f="";a.each(b,function(e,g){g.optgroup!==f&&(a("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(g.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:g.optgroup}).appendTo(d),f=g.optgroup),c._renderItemData(d,g)})},_renderItemData:function(b,c){return this._renderItem(b,c).data("ui-selectmenu-item",c)},_renderItem:function(d,b){var c=a("<li>");return b.disabled&&c.addClass("ui-state-disabled"),this._setText(c,b.label),c.appendTo(d)},_setText:function(b,c){c?b.text(c):b.html("&#160;")},_move:function(c,f){var b,d,g=".ui-menu-item";this.isOpen?b=this.menuItems.eq(this.focusIndex):(b=this.menuItems.eq(this.element[0].selectedIndex),g+=":not(.ui-state-disabled)"),d="first"===c||"last"===c?b["first"===c?"prevAll":"nextAll"](g).eq(-1):b[c+"All"](g).eq(0),d.length&&this.menuInstance.focus(f,d)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(b){this[this.isOpen?"close":"open"](b)},_setSelection:function(){var b;this.range&&(window.getSelection?(b=window.getSelection(),b.removeAllRanges(),b.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(b){this.isOpen&&(a(b.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(b))}},_buttonEvents:{mousedown:function(){var b;window.getSelection?(b=window.getSelection(),b.rangeCount&&(this.range=b.getRangeAt(0))):this.range=document.selection.createRange()},click:function(b){this._setSelection(),this._toggle(b)},keydown:function(c){var b=!0;switch(c.keyCode){case a.ui.keyCode.TAB:case a.ui.keyCode.ESCAPE:this.close(c),b=!1;break;case a.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(c);break;case a.ui.keyCode.UP:c.altKey?this._toggle(c):this._move("prev",c);break;case a.ui.keyCode.DOWN:c.altKey?this._toggle(c):this._move("next",c);break;case a.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(c):this._toggle(c);break;case a.ui.keyCode.LEFT:this._move("prev",c);break;case a.ui.keyCode.RIGHT:this._move("next",c);break;case a.ui.keyCode.HOME:case a.ui.keyCode.PAGE_UP:this._move("first",c);break;case a.ui.keyCode.END:case a.ui.keyCode.PAGE_DOWN:this._move("last",c);break;default:this.menu.trigger(c),b=!1}b&&c.preventDefault()}},_selectFocusedItem:function(b){var c=this.menuItems.eq(this.focusIndex);c.hasClass("ui-state-disabled")||this._select(c.data("ui-selectmenu-item"),b)},_select:function(c,d){var b=this.element[0].selectedIndex;this.element[0].selectedIndex=c.index,this._setText(this.buttonText,c.label),this._setAria(c),this._trigger("select",d,{item:c}),c.index!==b&&this._trigger("change",d,{item:c}),this.close(d)},_setAria:function(b){var c=this.menuItems.eq(b.index).attr("id");this.button.attr({"aria-labelledby":c,"aria-activedescendant":c}),this.menu.attr("aria-activedescendant",c)},_setOption:function(b,c){"icons"===b&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(c.button),this._super(b,c),"appendTo"===b&&this.menuWrap.appendTo(this._appendTo()),"disabled"===b&&(this.menuInstance.option("disabled",c),this.button.toggleClass("ui-state-disabled",c).attr("aria-disabled",c),this.element.prop("disabled",c),c?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===b&&this._resizeButton()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b&&b[0]||(b=this.element.closest(".ui-front")),b.length||(b=this.document[0].body),b},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var b=this.options.width;b||(b=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(b)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(c){var b=[];c.each(function(f,d){var h=a(d),g=h.parent("optgroup");b.push({element:h,index:f,value:h.val(),label:h.text(),optgroup:g.attr("label")||"",disabled:g.prop("disabled")||h.prop("disabled")})}),this.items=b},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}})});