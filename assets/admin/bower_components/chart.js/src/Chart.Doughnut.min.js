(function(){var c=this,b=c.Chart,d=b.helpers;var a={segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};b.Type.extend({name:"Doughnut",defaults:a,initialize:function(e){this.segments=[];this.outerRadius=(d.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2;this.SegmentArc=b.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2});if(this.options.showTooltips){d.bindEvents(this,this.options.tooltipEvents,function(f){var g=(f.type!=="mouseout")?this.getSegmentsAtEvent(f):[];d.each(this.segments,function(h){h.restore(["fillColor"])});d.each(g,function(h){h.fillColor=h.highlightColor});this.showTooltip(g)})}this.calculateTotal(e);d.each(e,function(g,f){this.addData(g,f,true)},this);this.render()},getSegmentsAtEvent:function(h){var g=[];var f=d.getRelativePosition(h);d.each(this.segments,function(e){if(e.inRange(f.x,f.y)){g.push(e)}},this);return g},addData:function(h,g,e){var f=g||this.segments.length;this.segments.splice(f,0,new this.SegmentArc({value:h.value,outerRadius:(this.options.animateScale)?0:this.outerRadius,innerRadius:(this.options.animateScale)?0:(this.outerRadius/100)*this.options.percentageInnerCutout,fillColor:h.color,highlightColor:h.highlight||h.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:Math.PI*1.5,circumference:(this.options.animateRotate)?0:this.calculateCircumference(h.value),label:h.label}));if(!e){this.reflow();this.update()}},calculateCircumference:function(e){return(Math.PI*2)*(Math.abs(e)/this.total)},calculateTotal:function(e){this.total=0;d.each(e,function(f){this.total+=Math.abs(f.value)},this)},update:function(){this.calculateTotal(this.segments);d.each(this.activeElements,function(e){e.restore(["fillColor"])});d.each(this.segments,function(e){e.save()});this.render()},removeData:function(f){var e=(d.isNumber(f))?f:this.segments.length-1;this.segments.splice(e,1);this.reflow();this.update()},reflow:function(){d.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2});this.outerRadius=(d.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2;d.each(this.segments,function(e){e.update({outerRadius:this.outerRadius,innerRadius:(this.outerRadius/100)*this.options.percentageInnerCutout})},this)},draw:function(e){var f=(e)?e:1;this.clear();d.each(this.segments,function(h,g){h.transition({circumference:this.calculateCircumference(h.value),outerRadius:this.outerRadius,innerRadius:(this.outerRadius/100)*this.options.percentageInnerCutout},f);h.endAngle=h.startAngle+h.circumference;h.draw();if(g===0){h.startAngle=Math.PI*1.5}if(g<this.segments.length-1){this.segments[g+1].startAngle=h.endAngle}},this)}});b.types.Doughnut.extend({name:"Pie",defaults:d.merge(a,{percentageInnerCutout:0})})}).call(this);