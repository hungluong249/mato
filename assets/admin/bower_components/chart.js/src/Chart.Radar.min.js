(function(){var b=this,a=b.Chart,c=a.helpers;a.Type.extend({name:"Radar",defaults:{scaleShowLine:true,angleShowLineOut:true,scaleShowLabels:false,scaleBeginAtZero:true,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:true,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:true,datasetStrokeWidth:2,datasetFill:true,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},initialize:function(d){this.PointClass=a.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx});this.datasets=[];this.buildScale(d);if(this.options.showTooltips){c.bindEvents(this,this.options.tooltipEvents,function(e){var f=(e.type!=="mouseout")?this.getPointsAtEvent(e):[];this.eachPoints(function(g){g.restore(["fillColor","strokeColor"])});c.each(f,function(g){g.fillColor=g.highlightFill;g.strokeColor=g.highlightStroke});this.showTooltip(f)})}c.each(d.datasets,function(f){var e={label:f.label||null,fillColor:f.fillColor,strokeColor:f.strokeColor,pointColor:f.pointColor,pointStrokeColor:f.pointStrokeColor,points:[]};this.datasets.push(e);c.each(f.data,function(g,h){var i;if(!this.scale.animation){i=this.scale.getPointPosition(h,this.scale.calculateCenterOffset(g))}e.points.push(new this.PointClass({value:g,label:d.labels[h],datasetLabel:f.label,x:(this.options.animation)?this.scale.xCenter:i.x,y:(this.options.animation)?this.scale.yCenter:i.y,strokeColor:f.pointStrokeColor,fillColor:f.pointColor,highlightFill:f.pointHighlightFill||f.pointColor,highlightStroke:f.pointHighlightStroke||f.pointStrokeColor}))},this)},this);this.render()},eachPoints:function(d){c.each(this.datasets,function(e){c.each(e.points,d,this)},this)},getPointsAtEvent:function(d){var i=c.getRelativePosition(d),f=c.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},i);var e=(Math.PI*2)/this.scale.valuesCount,g=Math.round((f.angle-Math.PI*1.5)/e),h=[];if(g>=this.scale.valuesCount||g<0){g=0}if(f.distance<=this.scale.drawingArea){c.each(this.datasets,function(j){h.push(j.points[g])})}return h},buildScale:function(d){this.scale=new a.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:(this.options.scaleShowLine)?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:(this.options.angleShowLineOut)?this.options.angleLineWidth:0,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:d.labels,valuesCount:d.datasets[0].data.length});this.scale.setScaleSize();this.updateScaleRange(d.datasets);this.scale.buildYLabels()},updateScaleRange:function(e){var d=(function(){var g=[];c.each(e,function(h){if(h.data){g=g.concat(h.data)}else{c.each(h.points,function(i){g.push(i.value)})}});return g})();var f=(this.options.scaleOverride)?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+(this.options.scaleSteps*this.options.scaleStepWidth)}:c.calculateScaleRange(d,c.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);c.extend(this.scale,f)},addData:function(e,d){this.scale.valuesCount++;c.each(e,function(f,h){var g=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(f));this.datasets[h].points.push(new this.PointClass({value:f,label:d,x:g.x,y:g.y,strokeColor:this.datasets[h].pointStrokeColor,fillColor:this.datasets[h].pointColor}))},this);this.scale.labels.push(d);this.reflow();this.update()},removeData:function(){this.scale.valuesCount--;this.scale.labels.shift();c.each(this.datasets,function(d){d.points.shift()},this);this.reflow();this.update()},update:function(){this.eachPoints(function(d){d.save()});this.reflow();this.render()},reflow:function(){c.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:c.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2});this.updateScaleRange(this.datasets);this.scale.setScaleSize();this.scale.buildYLabels()},draw:function(f){var e=f||1,d=this.chart.ctx;this.clear();this.scale.draw();c.each(this.datasets,function(g){c.each(g.points,function(h,i){if(h.hasValue()){h.transition(this.scale.getPointPosition(i,this.scale.calculateCenterOffset(h.value)),e)}},this);d.lineWidth=this.options.datasetStrokeWidth;d.strokeStyle=g.strokeColor;d.beginPath();c.each(g.points,function(h,i){if(i===0){d.moveTo(h.x,h.y)}else{d.lineTo(h.x,h.y)}},this);d.closePath();d.stroke();d.fillStyle=g.fillColor;d.fill();c.each(g.points,function(h){if(h.hasValue()){h.draw()}})},this)}})}).call(this);