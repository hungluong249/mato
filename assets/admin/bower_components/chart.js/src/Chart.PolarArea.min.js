(function(){var c=this,b=c.Chart,d=b.helpers;var a={scaleShowLabelBackdrop:true,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:true,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:true,segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};b.Type.extend({name:"PolarArea",defaults:a,initialize:function(e){this.segments=[];this.SegmentArc=b.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2});this.scale=new b.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:(this.options.scaleShowLine)?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:true,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:e.length});this.updateScaleRange(e);this.scale.update();d.each(e,function(g,f){this.addData(g,f,true)},this);if(this.options.showTooltips){d.bindEvents(this,this.options.tooltipEvents,function(f){var g=(f.type!=="mouseout")?this.getSegmentsAtEvent(f):[];d.each(this.segments,function(h){h.restore(["fillColor"])});d.each(g,function(h){h.fillColor=h.highlightColor});this.showTooltip(g)})}this.render()},getSegmentsAtEvent:function(h){var g=[];var f=d.getRelativePosition(h);d.each(this.segments,function(e){if(e.inRange(f.x,f.y)){g.push(e)}},this);return g},addData:function(h,g,e){var f=g||this.segments.length;this.segments.splice(f,0,new this.SegmentArc({fillColor:h.color,highlightColor:h.highlight||h.color,label:h.label,value:h.value,outerRadius:(this.options.animateScale)?0:this.scale.calculateCenterOffset(h.value),circumference:(this.options.animateRotate)?0:this.scale.getCircumference(),startAngle:Math.PI*1.5}));if(!e){this.reflow();this.update()}},removeData:function(f){var e=(d.isNumber(f))?f:this.segments.length-1;this.segments.splice(e,1);this.reflow();this.update()},calculateTotal:function(e){this.total=0;d.each(e,function(f){this.total+=f.value},this);this.scale.valuesCount=this.segments.length},updateScaleRange:function(f){var e=[];d.each(f,function(h){e.push(h.value)});var g=(this.options.scaleOverride)?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+(this.options.scaleSteps*this.options.scaleStepWidth)}:d.calculateScaleRange(e,d.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);d.extend(this.scale,g,{size:d.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments);d.each(this.segments,function(e){e.save()});this.reflow();this.render()},reflow:function(){d.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2});this.updateScaleRange(this.segments);this.scale.update();d.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2});d.each(this.segments,function(e){e.update({outerRadius:this.scale.calculateCenterOffset(e.value)})},this)},draw:function(f){var e=f||1;this.clear();d.each(this.segments,function(h,g){h.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(h.value)},e);h.endAngle=h.startAngle+h.circumference;if(g===0){h.startAngle=Math.PI*1.5}if(g<this.segments.length-1){this.segments[g+1].startAngle=h.endAngle}h.draw()},this);this.scale.draw()}})}).call(this);