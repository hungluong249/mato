var sys=require("system"),page=new WebPage();page.viewportSize={width:800,height:600};page.open(sys.args[1],function(a){if(a!=="success"){console.log("Bad status: %s",a);phantom.exit(1)}window.setTimeout(function(){var b=page.evaluate(function(){var i,g,h,j,f=10,e,d;if(window.setup){window.setup()}d=$("body").data("show");d=d?$(d):$("*");d.filter(function(){return"datepicker" in $(this).data()}).datepicker("show");e=$($("body").data("capture"));h=e.map(function(){return $(this).offset().top}).toArray();i=e.map(function(){return $(this).offset().left}).toArray();j=e.map(function(){return $(this).offset().top+$(this).outerHeight()}).toArray();g=e.map(function(){return $(this).offset().left+$(this).outerWidth()}).toArray();var c={top:Math.min.apply(Math,h),left:Math.min.apply(Math,i)};c.width=Math.max.apply(Math,g)-c.left;c.height=Math.max.apply(Math,j)-c.top;return{top:Math.max(c.top-f,0),left:Math.max(c.left-f,0),width:c.width+2*f,height:c.height+2*f}});page.clipRect=b;page.render(sys.args[2]);phantom.exit()},1)});